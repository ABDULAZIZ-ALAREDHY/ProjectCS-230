import java.util.ArrayList;
import java.util.InputMismatchException;
import java.util.Scanner;

public class Main {

    private static final Scanner scanner = new Scanner(System.in);

    public static void main(String[] args) {

        ArrayList<Person> records = new ArrayList<>();
        int choice;

        System.out.println("=======================================");
        System.out.println("    Ø¨Ø±Ù†Ø§Ù…Ø¬ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ© Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© (CS230)");
        System.out.println("=======================================");

        while (true) {
            System.out.println("\nØ§Ø®ØªØ§Ø± ÙˆØ§Ø­Ø¯ Ù…Ù† Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª Ø§Ù„Ù„ÙŠ ØªØ­Øª:");
            System.out.println("1. Ø¥Ø¶Ø§ÙØ© Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯");
            System.out.println("2. Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„");
            System.out.println("3. Ø¥Ø¶Ø§ÙØ© Ù…ÙˆØ¸Ù Ø¯ÙˆØ§Ù… Ø¬Ø²Ø¦ÙŠ");
            System.out.println("4. Ø´ÙˆÙ ÙƒÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª");
            System.out.println("5. Ø®Ø±ÙˆØ¬ Ù…Ù† Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬");
            System.out.print("Ø§Ø®ØªÙŠØ§Ø±Ùƒ: ");

            try {
                choice = scanner.nextInt();
                scanner.nextLine();
            } catch (InputMismatchException e) {
                System.out.println("\nâŒ ØºÙ„Ø·: Ù„Ø§Ø²Ù… ØªØ¯Ø®Ù„ Ø±Ù‚Ù… Ù„Ù„Ø®ÙŠØ§Ø±.");
                scanner.nextLine(); // Ù…Ø³Ø­ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø®Ø§Ø·Ø¦
                continue;
            }

            switch (choice) {
                case 1:
                    addStudent(records);
                    break;
                case 2:
                    addFullTimeEmployee(records);
                    break;
                case 3:
                    addPartTimeEmployee(records);
                    break;
                case 4:
                    displayAllRecords(records);
                    break;
                case 5:
                    System.out.println("\nâœ… ÙŠØ¹Ø·ÙŠÙƒ Ø§Ù„Ø¹Ø§ÙÙŠØ©ØŒ Ù…Ø¹ Ø§Ù„Ø³Ù„Ø§Ù…Ø©.");
                    scanner.close();
                    return;
                default:
                    System.out.println("\nâŒ ØºÙ„Ø·: Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù„ÙŠ Ø¯Ø®Ù„ØªÙ‡ Ù…Ùˆ Ù…ÙˆØ¬ÙˆØ¯ Ø¨Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª.");
            }
        }
    }

    public static void addStudent(ArrayList<Person> records) {
        System.out.println("\n--- Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ø·Ø§Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ ---");

        String name = getValidNameInput("Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø·Ø§Ù„Ø¨: ");
        // ğŸ”‘ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯Ø§Ù„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ID ÙØ±ÙŠØ¯
        int id = getUniqueIdInput("Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ (ID) Ø§Ù„ÙØ±ÙŠØ¯: ", records);

        System.out.print("Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø§Ø¯Ø©: ");
        String course = scanner.nextLine();

        double grade = getValidGradeInput("Ø¯Ø®Ù„ Ø§Ù„Ø¯Ø±Ø¬Ø© (Ø¨ÙŠÙ† 0-100): ");

        Student newStudent = new Student(name, id, course, grade);
        records.add(newStudent);
        System.out.println("\nâœ… Ø³Ø¬Ù„Ù†Ø§ Ø§Ù„Ø·Ø§Ù„Ø¨ " + name + " Ø¨Ù†Ø¬Ø§Ø­.");
    }

    public static void addFullTimeEmployee(ArrayList<Person> records) {
        System.out.println("\n--- Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¸Ù Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„ ---");

        String name = getValidNameInput("Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù: ");
        // ğŸ”‘ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯Ø§Ù„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ID ÙØ±ÙŠØ¯
        int id = getUniqueIdInput("Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ (ID) Ø§Ù„ÙØ±ÙŠØ¯: ", records);

        double monthlySalary = getValidDoubleInput("Ø¯Ø®Ù„ Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ (Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨): ");

        if (monthlySalary != -1) {
            FullTimeEmployee newFTE = new FullTimeEmployee(name, id, monthlySalary);
            records.add(newFTE);
            System.out.println("\nâœ… Ø³Ø¬Ù„Ù†Ø§ Ø§Ù„Ù…ÙˆØ¸Ù " + name + " Ø¨Ù†Ø¬Ø§Ø­.");
        }
    }

    public static void addPartTimeEmployee(ArrayList<Person> records) {
        System.out.println("\n--- Ø¯Ø®Ù„ Ø¨ÙŠØ§Ù†Ø§Øª Ù…ÙˆØ¸Ù Ø¯ÙˆØ§Ù… Ø¬Ø²Ø¦ÙŠ ---");

        String name = getValidNameInput("Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù: ");
        // ğŸ”‘ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ Ù‡Ù†Ø§: Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¯Ø§Ù„Ø© Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ID ÙØ±ÙŠØ¯
        int id = getUniqueIdInput("Ø¯Ø®Ù„ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ (ID) Ø§Ù„ÙØ±ÙŠØ¯: ", records);

        double hourlyRate = getValidDoubleInput("Ø¯Ø®Ù„ Ø£Ø¬Ø± Ø§Ù„Ø³Ø§Ø¹Ø© (Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨): ");

        int hoursWorked = getValidIntegerInput("Ø¯Ø®Ù„ Ø¹Ø¯Ø¯ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø´ØºÙ„ (Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨): ");

        if (hourlyRate != -1 && hoursWorked != -1) {
            PartTimeEmployee newPTE = new PartTimeEmployee(name, id, hourlyRate, hoursWorked);
            records.add(newPTE);
            System.out.println("\nâœ… Ø³Ø¬Ù„Ù†Ø§ Ø§Ù„Ù…ÙˆØ¸Ù " + name + " Ø¨Ù†Ø¬Ø§Ø­.");
        }
    }

    public static void displayAllRecords(ArrayList<Person> records) {
        if (records.isEmpty()) {
            System.out.println("\nğŸ’¡ Ù…Ø§ ÙÙŠÙ‡ Ø£ÙŠ Ø³Ø¬Ù„Ø§Øª Ø­Ø§Ù„ÙŠØ§Ù‹ Ø¹Ø´Ø§Ù† Ù†Ø¹Ø±Ø¶Ù‡Ø§.");
            return;
        }

        int fullTimeCount = 0;
        int partTimeCount = 0;
        int studentCount = 0;
        int totalEmployees = 0;

        System.out.println("\n=========== ÙƒÙ„ Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯Ù†Ø§ (" + records.size() + ") ===========");

        for (Person member : records) {
            member.displayDetails();

            if (member instanceof FullTimeEmployee) {
                FullTimeEmployee emp = (FullTimeEmployee) member;
                System.out.println("Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨: " + emp.calculateSalary() + " Ø±ÙŠØ§Ù„");
                fullTimeCount++;
                totalEmployees++;
                System.out.println("========================================");
            } else if (member instanceof PartTimeEmployee) {
                PartTimeEmployee emp = (PartTimeEmployee) member;
                System.out.println("Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù…Ø­Ø³ÙˆØ¨: " + emp.calculateSalary() + " Ø±ÙŠØ§Ù„");
                partTimeCount++;
                totalEmployees++;
                System.out.println("========================================");
            } else if (member instanceof Student) {
                studentCount++;
                System.out.println("========================================");
            }
        }

        System.out.println("\nğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©:");
        System.out.println("  - Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø³Ø¬Ù„Ø§Øª: " + records.size());
        System.out.println("  - Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨ Ø§Ù„Ù…ÙØ³Ø¬Ù‘ÙÙ„ÙŠÙ†: " + studentCount);
        System.out.println("  - Ø¹Ø¯Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¯ÙˆØ§Ù… Ø§Ù„ÙƒØ§Ù…Ù„: " + fullTimeCount);
        System.out.println("  - Ø¹Ø¯Ø¯ Ù…ÙˆØ¸ÙÙŠÙ† Ø§Ù„Ø¯ÙˆØ§Ù… Ø§Ù„Ø¬Ø²Ø¦ÙŠ: " + partTimeCount);
        System.out.println("  - Ø§Ù„Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ†: " + totalEmployees);
        System.out.println("========================================");

        if (totalEmployees > 0 && studentCount > 0) {
            System.out.println("\nâœ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ©: Ø³Ø¬Ù„Ù†Ø§ Ù…ÙˆØ¸ÙÙŠÙ† ÙˆØ·Ù„Ø§Ø¨ ÙÙŠ Ù†ÙØ³ Ø§Ù„ÙˆÙ‚ØªØŒ Ø´ØºÙ„Ù†Ø§ ØªÙ…Ø§Ù….");
        } else if (totalEmployees > 0) {
            System.out.println("\nâœ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ©: Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù‡ÙŠ Ù„Ù„Ù…ÙˆØ¸ÙÙŠÙ† ÙÙ‚Ø·.");
        } else if (studentCount > 0) {
            System.out.println("\nâœ¨ Ù…Ù„Ø§Ø­Ø¸Ø© Ø¥Ø­ØµØ§Ø¦ÙŠØ©: Ø§Ù„Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù‡ÙŠ Ù„Ù„Ø·Ù„Ø§Ø¨ ÙÙ‚Ø·.");
        }
    }

    public static String getValidNameInput(String prompt) {
        String name = "";
        while (true) {
            System.out.print(prompt);
            name = scanner.nextLine();
            if (name.matches("^[a-zA-Z\\u0600-\\u06FF\\s]+$") && !name.trim().isEmpty()) {
                break;
            } else {
                System.out.println("âš ï¸ ØºÙ„Ø·: Ø§Ù„Ø§Ø³Ù… Ù„Ø§Ø²Ù… ÙŠÙƒÙˆÙ† Ø­Ø±ÙˆÙ ÙˆÙ…Ø³Ø§ÙØ§Øª Ø¨Ø³.");
            }
        }
        return name;
    }

    public static double getValidGradeInput(String prompt) {
        double grade = -1;
        while (grade == -1) {
            System.out.print(prompt);
            try {
                grade = scanner.nextDouble();
                scanner.nextLine();
                if (grade < 0 || grade > 100) {
                    System.out.println("âš ï¸ ØºÙ„Ø·: Ø§Ù„Ø¯Ø±Ø¬Ø© Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ø¨ÙŠÙ† 0 Ùˆ 100.");
                    grade = -1;
                }
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ ØºÙ„Ø·: Ù„Ø§Ø²Ù… ØªØ¯Ø®Ù„ Ø±Ù‚Ù….");
                scanner.nextLine();
            }
        }
        return grade;
    }

    // ğŸ†• Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙØ±Ø§Ø¯Ø© Ø§Ù„Ù€ ID ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
    public static boolean isIdUnique(int id, ArrayList<Person> records) {
        for (Person member : records) {
            // ÙŠÙØªØ±Ø¶ Ø£Ù† ÙØ¦Ø© Person ØªØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ Ø¯Ø§Ù„Ø© getId()
            if (member.getId() == id) {
                return false; // Ø§Ù„Ø±Ù‚Ù… Ù…ÙˆØ¬ÙˆØ¯
            }
        }
        return true; // Ø§Ù„Ø±Ù‚Ù… ÙØ±ÙŠØ¯
    }

    // ğŸ†• Ø¯Ø§Ù„Ø© Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ID ÙØ±ÙŠØ¯ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    public static int getUniqueIdInput(String prompt, ArrayList<Person> records) {
        int input = -1;
        while (input == -1) {
            System.out.print(prompt);
            try {
                input = scanner.nextInt();
                scanner.nextLine();
                if (input < 0) {
                    System.out.println("âš ï¸ ØºÙ„Ø·: Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨Ø©.");
                    input = -1;
                } 
                // ğŸ›‘ Ù†Ù‚Ø·Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù€ Unique 
                else if (!isIdUnique(input, records)) {
                    System.out.println("âŒ Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ØªØ¹Ø±ÙŠÙÙŠ " + input + " Ù…Ø³ØªØ®Ø¯Ù… Ø¨Ø§Ù„ÙØ¹Ù„. Ø¯Ø®Ù„ Ø±Ù‚Ù… ÙØ±ÙŠØ¯.");
                    input = -1; 
                }
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ ØºÙ„Ø·: Ù„Ø§Ø²Ù… Ø§Ù„Ø±Ù‚Ù… ÙŠÙƒÙˆÙ† ØµØ­ÙŠØ­ (Ù…Ø§ ÙÙŠÙ‡ ÙÙˆØ§ØµÙ„).");
                scanner.nextLine();
            }
        }
        return input;
    }

    public static int getValidIntegerInput(String prompt) {
        int input = -1;
        while (input == -1) {
            System.out.print(prompt);
            try {
                input = scanner.nextInt();
                scanner.nextLine();
                if (input < 0) {
                    System.out.println("âš ï¸ ØºÙ„Ø·: Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨Ø©.");
                    input = -1;
                }
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ ØºÙ„Ø·: Ù„Ø§Ø²Ù… Ø§Ù„Ø±Ù‚Ù… ÙŠÙƒÙˆÙ† ØµØ­ÙŠØ­ (Ù…Ø§ ÙÙŠÙ‡ ÙÙˆØ§ØµÙ„).");
                scanner.nextLine();
            }
        }
        return input;
    }

    public static double getValidDoubleInput(String prompt) {
        double input = -1;
        while (input == -1) {
            System.out.print(prompt);
            try {
                input = scanner.nextDouble();
                scanner.nextLine();
                if (input < 0) {
                    System.out.println("âš ï¸ ØºÙ„Ø·: Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ù…ÙˆØ¬Ø¨Ø© Ø£Ùˆ ØµÙØ±.");
                    input = -1;
                }
            } catch (InputMismatchException e) {
                System.out.println("âš ï¸ ØºÙ„Ø·: Ø§Ù„Ù‚ÙŠÙ…Ø© Ù„Ø§Ø²Ù… ØªÙƒÙˆÙ† Ø±Ù‚Ù….");
                scanner.nextLine();
            }
        }
        return input;
    }
